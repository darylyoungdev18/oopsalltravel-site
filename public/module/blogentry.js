let blogEntries = [
    {
        id: "1-blog",
        img_src: "images/Amsterdam_bridge_Netherlands.jpg",
        title: "A Weekend In Amsterdam",
        details: "My first time in Amsterdam was wonderful. I traveled there by train from Germany, and six hours later, I was there. I went for New Year's and found myself enchanted by the city's unique charm. Floating through the canals of Amsterdam was a serene experience, with the historic buildings lining the waterways enhancing the city's picturesque beauty. One of the interesting thing about the canal is that all of the buildings look as though it was leaning forward towards it. Felt a lot like a painting that kept moving. Speaking of paintings, my excitement peaked at the Van Gogh Museum, where I delved into the world of this prolific artist, marveling at his stirring works and gaining deeper insights into his troubled yet brilliant mind. The food was also a huge highlight, nothing compared to the rich, buttery apple pie that I savored at a cozy cafe, its taste encapsulating the warmth of Dutch hospitality. Ringing in the New Year in such a vibrant city filled me with happiness, making my trip to Amsterdam an unforgettable start to the year.",
        city: "Amsterdam",
        country: "Netherlands"
    },
    {
        id: "2-blog",
        img_src: "images/Porto_bridge_Portugal.jpg",
        title: "A Sunny Porto",
        details: "Porto is one of my favorite places ever visited. I went at a time where I was weary from my rigorous schedule in search of relief of some kind. I found that relief day one of being there. The locals that I met in Porto were extremely friendly, they were all happy with having visitors to their city. The city was beyond beautiful as well as easy to commute through. I believe I walked through the most popular parts of it in about a day. The food was absolutely amazing, everything was rich in flavor. There was a dish that is called bacalhau in Portuguese (salt cod fish in English) that became a surprising favorite dish of mine out there.  The beach near Porto was the prettiest one I saw at the time; it was the first time I saw water that green before in my life. It was also the first time I saw a sunset at the beach being that I’ve always lived on the east coast growing up. I will never forget the feeling of safety, freedom and happiness I felt while there. ",
        city: "Porto",
        country: "Portugal"
    },
    {
        id: "3-blog",
        img_src: "images/Acropolis_Greece.jpg",
        title: "Exploring The Ruins of Athens In Modern Fashion",
        details: "Athens was a bustling city and surprisingly warm for me. The Mediterranean breeze was very much active the day I visited so it made it bearable. I was impress with how the city had so many of it’s ancient structures in tac, while still developing modern structures throughout the area. I was a bit disappointed in the food that I had while out there, I think I just picked some bad spots so had a few lackluster meals. The desserts were still good, I had a caramel donut that almost made up for the other dishes.  The top of the view from the Acropolis is one that I find hard to describe with words. It was the highlight of my short stay in Athens. The walk started off light but then became quite the workout. It is crazy to thing people actively traveled to it daily. But I could not think of a better place to engage in philosophical debates once I saw the view at the tip.",
        city: "Athens",
        country: "Greece"
    },
    {
        id: "4-blog",
        img_src: "images/usa-whitemountain.jpg",
        title: "Mini Hike In The Whites",
        details: "I’m not that big into hiking but I definitely recommend going to the White Mountains in New Hampshire. The drive is beautifully scenic and calming to the soul. Once I got to the area, I began to go down a trail that was filled with nothing but peace, quiet and nature. I couldn’t believe how being in that environment instantly made me feel like a kid again as I set out to explore the lush area. One of the most memorable area was by the river, I was too eager to jump form bolder to bolder just so that I could get to the center of the river to take multiple pictures.",
        city: "White Mountains",
        country: "USA"
    },
    {
        id: "5-blog",
        img_src: "images/usa-rockefeller.jpg",
        title: "Big Apple, My Home",
        details: "Born and raised in New York City, each corner of this bustling metropolis holds a story for me. Riding the subway, I've traversed the city's vibrant neighborhoods, each ride leading to a new adventure. The food here is unrivaled, from sizzling street food to gourmet delights, every bite is a taste of the world. One of my cherished memories is watching the breathtaking 'The Lion King' musical on Broadway, a spectacle of art and creativity. Yet, the most stunning view of all is from the Top of the Rock. Gazing out over the expansive skyline, the city's heartbeat beneath me, I'm reminded why I love my hometown—an ever-evolving canvas of experiences and sights.",
        city: "New York City",
        country: "USA"
    },
    {
        id: "6-blog",
        img_src: "images/Lisbon_Plaza_Portugal.jpg",
        title: "Lisbon Hospitality",
        details: "Lisbon was another great place I explored while in Portugal. I actually drove there from Porto, so it became an unforgettable mini- road trip.  The city was full of life and every individual I ran into was very friendly. There was one exchange I had with a local once I got near my Airbnb because they thought I was Portuguese and began speaking it to me. After I told them I wasn’t they were still extremely friendly as we all went our merry way. I went to the highest point in the city to take in the view but enjoyed the view I got at the harbor plaza more. I recommend taking the trip to Lisbon if you never been before. ",
        city: "Lisbon",
        country: "Portugal"
    },
    {
        id: "7-blog",
        img_src: "images/island_Punta_Cana_DR2.jpg.png",
        title: "An Exciting Punta Cana Trip",
        details: "The most exciting place I have been so far was the Dominican Republic. I visited to celebrate the new year with my girlfriend and was blown away with how beautiful the beaches were there. It was the equivalent of looking at a TV show depiction of a beach paradise. I was ecstatic to see some coral reefs as well as swim in a natural pool with water that was clear enough to see your feet. Our adventure continued as we rode ATVs through lush jungles, feeling the thrill of the wild terrain beneath us. We visited the home of a local who worked at a cocoa farm, gaining insight into the rural Dominican lifestyle. Topping off the experience, I drove a speedboat for the first time, racing across the ocean’s surface, which was absolutely thrilling. Every moment in Punta Cana was a treasure, filled with new experiences and scenic beauty.",
        city: "Punta Cana",
        country: "Dominican Republic"
    },
    {
        id: "8-blog",
        img_src: "images/Doha_Qatar.jpg",
        title: "A different World In The Same One",
        details: "My trip to Doha, Qatar, was a fascinating blend of culture, climate, and tasty delights. Doha's walkability allowed me to explore its unique charm comfortably on foot, immersing myself in a cityscape where traditional attire vividly contrasts with what's typical in America. The heat peaked midday, so locals and visitors alike thronged the streets at sunset, adding a vibrant life to the evening. Bartering with friendly locals was a highlight, giving me a taste of authentic interaction. I savored the best steak of my life at a local butcher shop and experienced my first delicious shawarma, making my visit to Doha unforgettable.",
        city: "Doha",
        country: "Qatar"
    },
    {
        id: "9-blog",
        img_src: "images/italy-venice-canal.jpg",
        title: "Wandering Venice",
        details: "My trip to Venice was an enchanting journey through time and beauty. Gliding through the city on a gondola, I was captivated by the serene waters and the historic charm of the floating city. The buildings, with their intricate architecture, stood as silent narrators of history; some hadn't been altered in over 400 years, their façades telling tales of centuries past. Culinary explorations were just as thrilling—Venetian pizza had a unique twist that delighted my taste buds, while the local pasta dishes, rich with flavor, provided a deeper taste of the city’s gastronomic heritage. Every moment spent in Venice was like a step through a living museum, wrapped in the exquisite allure of its endless canals and timeless beauty.",
        city: "Venice",
        country: "Italy"
    },
    {
        id: "10-blog",
        img_src: "images/Old_Rome_Italy.jpg",
        title: "Did As The Romans",
        details: "I can never forget the time I spent visiting Rome, it was nothing short of awe-inspiring. Navigating Rome was surprisingly easy, with buses and Ubers efficiently connecting me to the myriad of historical and modern delights the city offers. I was able to use the transportation to get to the Colosseum earlier in the day. The arena transported me back to ancient Rome, where the echoes of gladiators resonated through the grand arena, adjacent to the captivating ruins of old Rome. From there I took the time to journey to the Vatican, the holiest place in catholic religion. While I myself am not catholic, I was eager to immerse myself in the art work that was a representation of love. Inside the Vatican, the exquisite Roman art left me speechless, with each masterpiece weaving a narrative of devotion and artistic brilliance. I had to take advantage of the moment by taking pictures and videos. Outside the Vatican about three blocks away, I was fortunate enough to enjoy the second-best pizza of my life. It was almost better than the slices that I favor back home for me. I would love to go back to experience it all again if I could.",
        city: "Rome",
        country: "Italy"
    }
];
const blogPreview = document.querySelector('.blog-preview');
const singleBlog = document.querySelector('.single-blog');
const countryFilter = document.querySelector('#countryFilter');
const countryBlog = document.querySelector('.preview-country-blog');
const allBlogs = document.querySelector('.all-blogs')

export function populateCountryFilter() {
    let uniqueCountries = new Set(blogEntries.map(entry => entry.country));
    countryFilter.innerHTML = '<option value="">Select Country</option>';
    uniqueCountries.forEach(country => {
        let option = document.createElement('option');
        option.value = country;
        option.textContent = country;
        countryFilter.appendChild(option);
    });

    const urlParams = new URLSearchParams(window.location.search);
    const selectedCountry = urlParams.get('country');
    if (selectedCountry) {
        countryFilter.value = selectedCountry;
        filterBlogs(selectedCountry);
    }
}

export function displayAllBlogs() {
    singleBlog.classList.add("hide");
    singleBlog.classList.remove("fade-in-content");
    countryBlog.classList.add("hide");
    countryBlog.classList.remove("fade-in-content");
    blogPreview.innerHTML = '';
    blogEntries.forEach((entry, index) =>{
        let previewDiv = document.createElement('div');
        previewDiv.className = 'preview-div'; 
        previewDiv.innerHTML = `
            <img class="preview-img" src="${entry.img_src}"/>
            <h3 class="preview-title">${entry.title}</h3>
        `;
        previewDiv.onclick = () => showBlog(index);
        blogPreview.appendChild(previewDiv);
    });
    blogPreview.classList.remove("hide");
    blogPreview.classList.add("fade-in-content");
            updateURL(); // Clear all parameters from URL
};

export function filterBlogs(country) {
    countryBlog.innerHTML=``;
    blogPreview.innerHTML = '';
    singleBlog.classList.add("hide");
    singleBlog.classList.remove("fade-in-content");
    let filteredEntries = blogEntries.filter(entry => entry.country === country);
    filteredEntries.forEach((entry, index) => createBlogPreview(entry, index));
    updateURL('country', country); // Set country parameter in URL
}

export function createBlogPreview(entry, index) {
    
    countryBlog.classList.remove("hide");
    countryBlog.classList.add("fade-in-content")
    countryBlog.insertAdjacentHTML ('beforeend', `<div class="preview-div"><img class="preview-img" src="${entry.img_src}"/> 
        <h3 class="preview-title">${entry.title}</h3><div>`);// use insertAdjacent HTML to created new divs 
    countryBlog.onclick = () => showBlog(blogEntries.indexOf(entry)); // Ensure proper index
    allBlogs.appendChild(countryBlog);
}

export function showBlog(index) {
    blogPreview.innerHTML ='';
    countryBlog.innerHTML ='';
    const entry = blogEntries[index];
    singleBlog.innerHTML = `
        <div class="blog-layout">
        <div class="blog-content-layout">
        <h3 class="blog-title">${entry.title}</h3>
        <p class="blog-content">${entry.details}</p>
        </div>
        <img class="blog-image" src="${entry.img_src}">
        </div>
    `;
    singleBlog.classList.remove("hide");
    singleBlog.classList.add("fade-in-content");
    updateURL('blog', entry.id); // Update URL to include blog ID, clear others
    addNavigationButtons(index);
}

export function updateURL(key = null, value = null) {
    const url = new URL(window.location);
    url.searchParams.delete('country'); // Always clear country when updating
    url.searchParams.delete('blog'); // Clear blog as well when not needed
    if (key && value) {
        url.searchParams.set(key, value);
    }
    window.history.pushState({}, '', url);
}

export function addNavigationButtons(currentIndex) {
    const navContainer = document.createElement('div');
    navContainer.className = 'blog-nav-buttons';
    if (currentIndex > 0) {
        const prevButton = document.createElement('button');
        prevButton.innerText = 'Previous';
        prevButton.onclick = () => showBlog(currentIndex - 1);
        navContainer.appendChild(prevButton);
    }
    if (currentIndex < blogEntries.length - 1) {
        const nextButton = document.createElement('button');
        nextButton.innerText = 'Next';
        nextButton.onclick = () => showBlog(currentIndex + 1);
        navContainer.appendChild(nextButton);
    }
    const showAllButton = document.createElement('button');
    showAllButton.innerText = 'Show All';
    showAllButton.onclick = displayAllBlogs;
    navContainer.appendChild(showAllButton);
    singleBlog.appendChild(navContainer);
}


window.addEventListener("DOMContentLoaded", function() {
    populateCountryFilter(); // Setup filters
    const urlParams = new URLSearchParams(window.location.search);
    const country = urlParams.get('country');

    console.log("Country from URL:", country); // needed for testing url

    if (country) {
        const countryOption = Array.from(countryFilter.options).find(option => option.value.toLowerCase() === country.toLowerCase());
        console.log("Matching option in filter:", countryOption); // test comparison

        if (countryOption) {
            countryFilter.value = countryOption.value; // Ensure exact match from options
            filterBlogs(countryOption.value); // Apply the filter based on the URL parameter
        } else {
            console.error("No matching country found in filter options.");
            displayAllBlogs();
        }
    } else {
        displayAllBlogs(); // Display all blogs if no country parameter is set
    }

    // Setup the change event listener after initializing the state from URL
    countryFilter.addEventListener('change', () => {
        if (countryFilter.value === '') {
            displayAllBlogs();
        } else {
            filterBlogs(countryFilter.value);
        }
    });
});
